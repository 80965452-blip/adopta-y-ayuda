<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Adopta y Ayuda - Adopciones</title>
  <meta name="description" content="Adopta y Ayuda - Adopta a tu nuevo mejor amigo. Proyecto escolar.">
  <style>
    :root {
      --bg: #f6f8fc;
      --card: #fff;
      --accent: #2b8aef;
      --accent2: #6dd3ff;
      --muted: #6b7280;
      --radius: 14px;
      --danger: #e11d48;
      font-family: "Segoe UI", Roboto, Inter, Arial;
    }
    body {
      margin: 0;
      background: linear-gradient(180deg,#eef2ff 0%,var(--bg) 100%);
      color: #0f172a;
    }
    header {
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      color: #fff;
      padding: 30px 18px;
      border-bottom-left-radius: 18px;
      border-bottom-right-radius: 18px;
      text-align: center;
    }
    h1 { margin: 0; font-size: 32px; letter-spacing: -0.5px; }
    p.lead { margin: 6px 0 0; opacity: .95 }

    .container { max-width: 1100px; margin: 22px auto; padding: 0 18px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap: 20px; margin-top: 18px; }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: 0 4px 12px rgba(11,15,30,0.1);
      display: flex; flex-direction: column;
      transition: transform .2s, box-shadow .2s;
    }
    .card:hover { transform: translateY(-4px); box-shadow: 0 6px 18px rgba(11,15,30,0.15); }
    .thumb { height: 180px; border-radius: 12px; background-size: cover; background-position: center; margin-bottom: 12px; }
    .meta { display: flex; gap: 8px; align-items: center; justify-content: space-between }
    .name { font-weight: 700; font-size: 18px }
    .muted { color: var(--muted); font-size: 13px }
    .actions { margin-top: auto; display: flex; gap: 8px; flex-wrap: wrap }
    button {
      cursor: pointer; border: 0; padding: 9px 12px;
      border-radius: 10px; background: var(--accent);
      color: #fff; font-weight: 600; font-size: 14px;
      transition: background .2s, transform .2s;
    }
    button:hover { background: #1a73e8; transform: translateY(-2px); }
    button.secondary { background: #eef2ff; color: var(--accent); font-weight: 700; }
    button.ghost { background: transparent; border: 1px solid #e6eefc; color: var(--accent); }
    .small { padding: 7px 10px; font-size: 13px }

    /* Modal */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(10,12,20,0.45); display: none; align-items: center; justify-content: center; padding: 18px; z-index: 100; }
    .modal { width: 100%; max-width: 700px; background: var(--card); border-radius: 14px; padding: 20px; box-shadow: 0 8px 28px rgba(0,0,0,0.25); animation: fadeIn .25s ease-in-out }
    @keyframes fadeIn { from { opacity: 0; transform: scale(.95); } to { opacity: 1; transform: scale(1); } }

    form .row { display: flex; gap: 10px; }
    label { font-weight: 600; font-size: 14px; display: block; margin-top: 8px }
    input[type="text"], textarea, select {
      width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #e6eefc; font-size: 14px;
    }
    textarea { min-height: 80px }
    .note { background: #fff6db; padding: 10px; border-radius: 8px; border: 1px solid #ffe4a3; color: #6b4a00; margin-top: 10px; }

    footer { margin: 28px 0 80px; color: var(--muted); text-align: center }

    /* Reviews */
    .reviews { margin-top: 12px }
    .review { border-top: 1px dashed #eef2ff; padding: 8px 0 }
    .rating { font-weight: 700; color: #fbbf24 }
    .stars { display: flex; gap: 4px; font-size: 20px; cursor: pointer; color: #d1d5db; }
    .stars span.active { color: #fbbf24; }

    @media (max-width:640px){ .thumb { height: 150px } }
  </style>
</head>
<body>
  <header>
    <h1>Adopta y Ayuda</h1>
    <p class="lead">Adopta a tu nuevo mejor amigo. Proyecto escolar.</p>
  </header>

  <main class="container">
    <section>
      <h2>Perros disponibles</h2>
      <p class="muted">Haz clic en <strong>Ver</strong> para más detalles, <strong>Compartir</strong> para enviar a un amigo o en <strong>Adoptar</strong> para iniciar la solicitud.</p>
      <div id="list" class="grid"></div>
    </section>

    <!-- Modal -->
    <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal" id="modalContent">
        <button id="closeModal" class="ghost small" style="float:right">Cerrar ✕</button>
        <div id="ficha"></div>
      </div>
    </div>

    <section style="margin-top:20px">
      <h3>Solicitudes recientes (simuladas)</h3>
      <div id="solicitudes" class="muted">No hay solicitudes aún.</div>
    </section>

    <footer>
      © Adopta y Ayuda — Proyecto escolar. Recomendado: Implementar backend para producción.
    </footer>
  </main>

<script>
const DOGS = [
  {id:'luna',name:'Luna',age:'2 años',breed:'Mestiza',desc:'Alegre y sociable, buena con niños.',img:'https://images.unsplash.com/photo-1629992086978-0e2d1f89a31c?w=400'},
  {id:'max',name:'Max',age:'4 años',breed:'Labrador',desc:'Cariñoso y tranquilo. Ideal para familias.',img:'https://images.unsplash.com/photo-1619983081563-43071a1e7ab1?w=400'},
  {id:'mora',name:'Mora',age:'1 año',breed:'Pequeña',desc:'Enérgica y curiosa. Necesita paseos diarios.',img:'https://images.unsplash.com/photo-1507149833265-60c372daea22?w=400'},
  {id:'rocky',name:'Rocky',age:'3 años',breed:'Pastor',desc:'Protectivo y leal. Requiere espacio para correr.',img:'https://images.unsplash.com/photo-1601979031059-3c350d6e7d52?w=400'},
  {id:'nina',name:'Nina',age:'5 años',breed:'Golden Retriever',desc:'Dulce y obediente, le encanta la compañía.',img:'https://images.unsplash.com/photo-1504595403659-9088ce801e29?w=400'},
  {id:'toby',name:'Toby',age:'2 años',breed:'Beagle',desc:'Travieso y amigable, muy curioso.',img:'https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=400'},
  {id:'kiara',name:'Kiara',age:'6 meses',breed:'Mestiza pequeña',desc:'Cachorra juguetona y cariñosa.',img:'https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=400'},
  {id:'duke',name:'Duke',age:'3 años',breed:'Husky',desc:'Energético y protector, necesita ejercicio diario.',img:'https://images.unsplash.com/photo-1583337130417-3346a1b2c779?w=400'},
  {id:'sasha',name:'Sasha',age:'4 años',breed:'Boxer',desc:'Noble y muy cariñosa.',img:'https://images.unsplash.com/photo-1558788353-f76d92427f16?w=400'},
  {id:'coco',name:'Coco',age:'2 años',breed:'French Bulldog',desc:'Simpático y juguetón.',img:'https://images.unsplash.com/photo-1582456891925-0055f8142fba?w=400'}
];

// Elements
const listEl = document.getElementById('list');
const modal = document.getElementById('modal');
const fichaEl = document.getElementById('ficha');
const closeModal = document.getElementById('closeModal');
const solicitudesEl = document.getElementById('solicitudes');

// Storage helpers
function loadReviews(){ return JSON.parse(localStorage.getItem('adopta_reviews')||'{}'); }
function saveReviews(obj){ localStorage.setItem('adopta_reviews',JSON.stringify(obj)); }
function loadSolicitudes(){ return JSON.parse(localStorage.getItem('adopta_solicitudes')||'[]'); }
function saveSolicitudes(arr){ localStorage.setItem('adopta_solicitudes',JSON.stringify(arr)); }

// Render list
function renderList(){
  listEl.innerHTML='';
  DOGS.forEach(d=>{
    const card=document.createElement('article');card.className='card';
    card.innerHTML=`
      <div class="thumb" style="background-image:url('${d.img}')"></div>
      <div class="meta"><div><div class="name">${d.name}</div><div class="muted">${d.age} • ${d.breed}</div></div></div>
      <p style="margin:8px 0 12px">${d.desc}</p>
      <div class="actions">
        <button class="secondary small" onclick="openFicha('${d.id}')">Ver</button>
        <button class="small" onclick="shareDog('${d.id}')">Compartir</button>
        <button class="small" onclick="startAdopt('${d.id}')">Adoptar</button>
      </div>`;
    listEl.appendChild(card);
  });
}

// Render solicitudes
function renderSolicitudes(){
  const s=loadSolicitudes();
  if(!s.length){solicitudesEl.textContent='No hay solicitudes aún.';return}
  solicitudesEl.innerHTML='';
  s.slice().reverse().forEach(req=>{
    const d=DOGS.find(x=>x.id===req.dogId)||{name:req.dogId};
    const div=document.createElement('div');div.style.marginBottom='8px';
    div.innerHTML=`<strong>${req.name}</strong> solicitó a <strong>${d.name}</strong> — Dirección: ${req.address} — Estado: <em>${req.status}</em>`;
    solicitudesEl.appendChild(div);
  });
}

// Modal
function openFicha(id){
  const dog=DOGS.find(d=>d.id===id);
  const reviews=loadReviews()[id]||[];
  fichaEl.innerHTML=`
    <h2>${dog.name} <small class="muted">(${dog.age})</small></h2>
    <p class="muted">${dog.breed}</p>
    <img src="${dog.img}" alt="Foto de ${dog.name}" style="width:100%;border-radius:12px;margin:10px 0">
    <p>${dog.desc}</p>
    <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
      <button onclick="startAdopt('${id}')">Adoptar</button>
      <button class="secondary" onclick="shareDog('${id}')">Compartir</button>
    </div>
    <hr>
    <h3>Reseñas</h3>
    <div class="reviews" id="reviews-${id}">
      ${reviews.length?reviews.map(r=>`<div class="review"><div class="rating">${'★'.repeat(r.rating)} ${'☆'.repeat(5-r.rating)}</div><div>${escapeHtml(r.text)}</div><div class="muted" style="font-size:13px">${new Date(r.date).toLocaleString()}</div></div>`).join(''):'<div class="muted">Aún no hay reseñas. Sé el primero.</div>'}
    </div>
    <hr>
    <h4>Dejar reseña</h4>
    <form id="reviewForm-${id}" onsubmit="event.preventDefault();submitReview('${id}')">
      <div class="stars" id="stars-${id}">${[1,2,3,4,5].map(i=>`<span data-v="${i}">★</span>`).join('')}</div>
      <input type="hidden" id="rating-${id}" value="5">
      <label for="text-${id}">Comentario</label>
      <textarea id="text-${id}" required></textarea>
      <div style="margin-top:8px"><button type="submit">Enviar reseña</button></div>
    </form>
  `;
  const starEls=document.querySelectorAll(`#stars-${id} span`);
  starEls.forEach(star=>{
    star.addEventListener('click',()=>{
      document.getElementById(`rating-${id}`).value=star.dataset.v;
      starEls.forEach(s=>s.classList.toggle('active',s.dataset.v<=star.dataset.v));
    });
  });
  showModal();
}

function escapeHtml(s){return String(s).replace(/[&<>"']/g,chr=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[chr]));}
function showModal(){modal.style.display='flex';modal.setAttribute('aria-hidden','false');}
function hideModal(){modal.style.display='none';modal.setAttribute('aria-hidden','true');}
closeModal.addEventListener('click',hideModal);
modal.addEventListener('click',e=>{if(e.target===modal)hideModal();});

// Adopción
function startAdopt(id){
  const dog=DOGS.find(d=>d.id===id);
  fichaEl.innerHTML=`
    <h2>Solicitud de adopción — ${dog.name}</h2>
    <p class="muted">Proporciona tu dirección. La solicitud se revisará en 3 semanas y, si se aprueba, podrás recoger al animal en 3 a 5 días.</p>
    <form id="adoptForm" onsubmit="event.preventDefault();submitAdoption('${id}')">
      <label>Nombre completo</label><input id="fullname" type="text" required>
      <label>Dirección</label><input id="address" type="text" required>
      <label>Teléfono (opcional)</label><input id="phone" type="text">
      <div style="margin-top:10px" class="note">Nota: Demo escolar. Los datos se guardan localmente.</div>
      <div style="margin-top:12px"><button type="submit">Enviar solicitud</button></div>
    </form>
  `;
  showModal();
}

function submitAdoption(dogId){
  const name=document.getElementById('fullname').value.trim();
  const address=document.getElementById('address').value.trim();
  if(!address){alert('La dirección es obligatoria.');return}
  const solicitudes=loadSolicitudes();
  const solicitud={id:'s_'+Date.now(),dogId,name:name||'Sin nombre',address,status:'En revisión',created:new Date().toISOString()};
  solicitudes.push(solicitud);saveSolicitudes(solicitudes);renderSolicitudes();
  fichaEl.innerHTML=`<h2>Solicitud enviada ✔</h2><p>Gracias <strong>${escapeHtml(solicitud.name)}</strong>. Tu solicitud para <strong>${DOGS.find(d=>d.id===dogId).name}</strong> está en revisión.</p><div class="note">Será revisada en 3 semanas y, si se aprueba, podrás recogerlo en 3–5 días.</div>`;
}

// Reviews
function submitReview(id){
  const rating=parseInt(document.getElementById(`rating-${id}`).value);
  const text=document.getElementById(`text-${id}`).value.trim();
  if(!text)return;
  const all=loadReviews(); if(!all[id])all[id]=[];
  all[id].push({rating,text,date:new Date().toISOString()});
  saveReviews(all); openFicha(id);
}
  // Share
function shareDog(id){
  const dog = DOGS.find(d => d.id === id);
  const url = window.location.href.split('#')[0] + '#' + id;
  if (navigator.share) {
    navigator.share({
      title: 'Adopta a ' + dog.name,
      text: dog.desc,
      url
    });
  } else {
    navigator.clipboard.writeText(url);
    alert("Enlace copiado al portapapeles: " + url);
  }
}

// Inicialización
renderList();
renderSolicitudes();
</script>

// Share
function shareDog(id){
  const dog=DOGS.find(d=>d.id===id);
  const url=window.location.href.split('#')[0]+'#'+id;
  if(navigator.share){navigator.share({title:'Adopta a
