<!--
Proyecto: Página web escolar - Adopta y Ayuda
Archivo: index.html
Descripción: Página única (HTML/CSS/JS) en español lista para subir a GitHub.
Instrucciones para publicar en GitHub:
  1. Crea un repositorio nuevo en GitHub (por ejemplo: adopta-y-ayuda).
  2. Añade este archivo como index.html en la raíz del repositorio.
  3. Commit y push al repositorio.
  4. En GitHub Settings -> Pages -> Source: main branch / root, habilita GitHub Pages. La web estará disponible en https://<tu-usuario>.github.io/<tu-repo>/

Características implementadas:
  - Listado de perros con fotos (placeholders), nombre, edad y descripción.
  - Sistema de adopción: elegir perro, completar dirección (obligatoria) y enviar solicitud.
    - Tras enviar, aparece un mensaje: "Su solicitud será revisada en un plazo de 3 semanas..." y "Podrá recogerlo en un plazo de 3 a 5 días como máximo".
  - Botón para compartir la ficha del perro (navigator.share o copiar enlace al portapapeles).
  - Sistema de reseñas por perro (guardadas en localStorage) con visualización.
  - Almacenamiento local para solicitudes y reseñas (simula backend).
  - Interfaz responsive y accesible, todo en español.

Nota: Este proyecto es una demo para uso escolar. Para producción se necesita un backend seguro para procesar solicitudes de adopción.
-->

<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Adopta y Ayuda - Adopciones</title>
  <meta name="description" content="Adopta y Ayuda - Adopta a tu nuevo mejor amigo. Sistema de adopción demo.">
  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --accent:#2b8aef; --muted:#6b7280; --danger:#e11d48; --glass: rgba(255,255,255,0.7);
      --radius:12px; font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#eef2ff 0%,var(--bg) 100%);color:#0f172a}
    header{background:linear-gradient(90deg,var(--accent),#6dd3ff);color:#fff;padding:28px 18px;border-bottom-left-radius:18px;border-bottom-right-radius:18px}
    .container{max-width:1100px;margin:22px auto;padding:0 18px}
    h1{margin:0;font-size:28px;letter-spacing:-0.5px}
    p.lead{margin:6px 0 0;opacity:.95}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px;margin-top:18px}
    .card{background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 6px 18px rgba(11,15,30,0.06);display:flex;flex-direction:column}
    .thumb{height:160px;border-radius:10px;background-size:cover;background-position:center;margin-bottom:12px}
    .meta{display:flex;gap:8px;align-items:center;justify-content:space-between}
    .name{font-weight:700}
    .muted{color:var(--muted);font-size:13px}
    .actions{margin-top:auto;display:flex;gap:8px}
    button{cursor:pointer;border:0;padding:10px 12px;border-radius:10px;background:var(--accent);color:#fff;font-weight:600}
    button.secondary{background:#eef2ff;color:var(--accent);font-weight:700}
    button.ghost{background:transparent;border:1px solid #e6eefc;color:var(--accent);}
    .small{padding:8px 10px;font-size:14px}

    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(10,12,20,0.45);display:none;align-items:center;justify-content:center;padding:18px}
    .modal{width:100%;max-width:640px;background:var(--card);border-radius:12px;padding:18px}

    form .row{display:flex;gap:10px}
    label{font-weight:600;font-size:14px}
    input[type="text"],textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eefc;font-size:14px}
    textarea{min-height:80px}

    .note{background:#fff6db;padding:10px;border-radius:8px;border:1px solid #ffe4a3;color:#6b4a00}

    footer{margin:28px 0 80px;color:var(--muted);text-align:center}

    /* Reviews */
    .reviews{margin-top:12px}
    .review{border-top:1px dashed #eef2ff;padding:8px 0}
    .rating{font-weight:700;color:var(--accent)}

    @media (max-width:640px){.thumb{height:140px}}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Adopta y Ayuda</h1>
      <p class="lead">Encuentra y solicita la adopción de tu compañero ideal. Este es un sistema demo para proyectos escolares.</p>
    </div>
  </header>

  <main class="container">
    <section aria-labelledby="catalogo">
      <h2 id="catalogo">Perros disponibles</h2>
      <p class="muted">Haz clic en <strong>Ver</strong> para más detalles o en <strong>Adoptar</strong> para iniciar la solicitud.</p>

      <div id="list" class="grid" aria-live="polite"></div>
    </section>

    <!-- Modal: ficha y adopción -->
    <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal" id="modalContent">
        <button id="closeModal" class="ghost small" style="float:right">Cerrar ✕</button>
        <div id="ficha"></div>
      </div>
    </div>

    <section style="margin-top:20px">
      <h3>Solicitudes recientes (simuladas)</h3>
      <div id="solicitudes" class="muted">No hay solicitudes aún.</div>
    </section>

    <footer>
      © Adopta y Ayuda — Proyecto escolar. Recomendado: Implementar backend para producción.
    </footer>
  </main>

<script>
// Datos iniciales (puedes editar o ampliar)
const DOGS = [
  {id:'luna',name:'Luna',age:'2 años',breed:'Mestiza',desc:'Alegre, sociable y le encanta jugar. Buena con niños.',img:'https://place-puppy.com/400x300'},
  {id:'max',name:'Max',age:'4 años',breed:'Labrador mix',desc:'Cariñoso y tranquilo. Ideal para familias.',img:'https://place-puppy.com/401x300'},
  {id:'mora',name:'Mora',age:'1 año',breed:'Pequeña',desc:'Enérgica y curiosa. Necesita paseos diarios.',img:'https://place-puppy.com/402x300'},
  {id:'oco',name:'Ocho',age:'3 años',breed:'Pastor',desc:'Protectivo y leal. Requiere espacio para correr.',img:'https://place-puppy.com/403x300'}
];

// Elementos
const listEl = document.getElementById('list');
const modal = document.getElementById('modal');
const fichaEl = document.getElementById('ficha');
const closeModal = document.getElementById('closeModal');
const solicitudesEl = document.getElementById('solicitudes');

// Storage helpers
function loadReviews(){
  return JSON.parse(localStorage.getItem('adopta_reviews')||'{}');
}
function saveReviews(obj){localStorage.setItem('adopta_reviews',JSON.stringify(obj));}

function loadSolicitudes(){
  return JSON.parse(localStorage.getItem('adopta_solicitudes')||'[]');
}
function saveSolicitudes(arr){localStorage.setItem('adopta_solicitudes',JSON.stringify(arr));}

// Render listado
function renderList(){
  listEl.innerHTML='';
  DOGS.forEach(d=>{
    const card = document.createElement('article');card.className='card';
    card.innerHTML = `
      <div class="thumb" style="background-image:url('${d.img}')" aria-hidden="true"></div>
      <div class="meta"><div><div class="name">${d.name}</div><div class="muted">${d.age} • ${d.breed}</div></div>
      <div class="muted">ID: ${d.id}</div></div>
      <p style="margin:8px 0 12px">${d.desc}</p>
      <div class="actions">
        <button class="secondary small" data-id="${d.id}" onclick="openFicha('${d.id}')">Ver</button>
        <button class="small" onclick="startAdopt('${d.id}')">Adoptar</button>
      </div>
    `;
    listEl.appendChild(card);
  });
}

// Render solicitudes
function renderSolicitudes(){
  const s = loadSolicitudes();
  if(!s.length){solicitudesEl.textContent='No hay solicitudes aún.';return}
  solicitudesEl.innerHTML='';
  s.slice().reverse().forEach(req=>{
    const d = DOGS.find(x=>x.id===req.dogId) || {name:req.dogId};
    const div = document.createElement('div');div.style.marginBottom='8px';
    div.innerHTML = `<strong>${req.name || 'Solicitante'}</strong> solicitó a <strong>${d.name}</strong> — Dirección: ${req.address} — Estado: <em>${req.status}</em>`;
    solicitudesEl.appendChild(div);
  });
}

// Modal open ficha
function openFicha(id){
  const dog = DOGS.find(d=>d.id===id);
  const reviews = loadReviews()[id]||[];
  fichaEl.innerHTML = `
    <div style="display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap">
      <div style="flex:1;min-width:220px">
        <div style="border-radius:10px;overflow:hidden"><img src="${dog.img}" alt="Foto de ${dog.name}" style="width:100%;display:block"></div>
      </div>
      <div style="flex:2;min-width:260px">
        <h2 style="margin-top:0">${dog.name} <small class="muted">(${dog.age})</small></h2>
        <p class="muted">${dog.breed}</p>
        <p>${dog.desc}</p>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button onclick="startAdopt('${id}')">Iniciar adopción</button>
          <button class="secondary" onclick="shareDog('${id}')">Compartir</button>
        </div>
        <hr>
        <h3>Reseñas</h3>
        <div class="reviews" id="reviews-${id}">
          ${reviews.length?reviews.map(r=>`<div class="review"><div class="rating">${'★'.repeat(r.rating)} ${'☆'.repeat(5-r.rating)}</div><div>${escapeHtml(r.text)}</div><div class="muted" style="font-size:13px">${new Date(r.date).toLocaleString()}</div></div>`).join(''):'<div class="muted">Aún no hay reseñas. Sé el primero.</div>'}
        </div>
        <hr>
        <h4>Dejar reseña</h4>
        <form id="reviewForm-${id}" onsubmit="event.preventDefault();submitReview('${id}')">
          <label for="rating">Puntuación (1-5)</label>
          <select id="rating-${id}" required>
            <option value="5">5 - Excelente</option>
            <option value="4">4 - Muy bueno</option>
            <option value="3">3 - Bueno</option>
            <option value="2">2 - Regular</option>
            <option value="1">1 - Malo</option>
          </select>
          <label for="text">Comentario</label>
          <textarea id="text-${id}" placeholder="Escribe aquí tu reseña" required></textarea>
          <div style="margin-top:8px"><button type="submit">Enviar reseña</button></div>
        </form>
      </div>
    </div>
  `;
  showModal();
}

function escapeHtml(s){return String(s).replace(/[&<>"']/g,chr=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[chr]));}

function showModal(){modal.style.display='flex';modal.setAttribute('aria-hidden','false');window.scrollTo({top:0,behavior:'smooth'});}
function hideModal(){modal.style.display='none';modal.setAttribute('aria-hidden','true');}
closeModal.addEventListener('click',hideModal);
modal.addEventListener('click',e=>{if(e.target===modal)hideModal();});

// Iniciar adopción: abre modal con formulario de dirección
function startAdopt(id){
  const dog = DOGS.find(d=>d.id===id);
  fichaEl.innerHTML = `
    <h2>Solicitud de adopción — ${dog.name}</h2>
    <p class="muted">Antes de poder adoptar, por favor proporciona tu dirección completa. Tras enviar, su solicitud será revisada en un plazo de <strong>3 semanas</strong>. Si se aprueba, podrá recoger al animal en un plazo de <strong>3 a 5 días</strong> como máximo.</p>
    <form id="adoptForm" onsubmit="event.preventDefault();submitAdoption('${id}')">
      <label for="fullname">Nombre completo</label>
      <input id="fullname" type="text" placeholder="Tu nombre" required>
      <label for="address">Dirección (calle, ciudad, código postal)</label>
      <input id="address" type="text" placeholder="Ej: Av. Principal 123, Lima, 15001" required>
      <label for="phone">Teléfono (opcional)</label>
      <input id="phone" type="text" placeholder="(+51) 9...">
      <div style="margin-top:10px" class="note">Nota: Esta es una demo. Los datos se guardan localmente para propósitos escolares.</div>
      <div style="margin-top:12px"><button type="submit">Enviar solicitud</button> <button type="button" class="ghost" onclick="hideModal()">Cancelar</button></div>
    </form>
  `;
  showModal();
}

// Submit adoption: guarda solicitud localmente y muestra mensaje requerido
function submitAdoption(dogId){
  const name = document.getElementById('fullname').value.trim();
  const address = document.getElementById('address').value.trim();
  const phone = document.getElementById('phone').value.trim();
  if(!address){alert('La dirección es obligatoria para continuar.');return}
  const solicitudes = loadSolicitudes();
  const solicitud = {
    id: 's_'+Date.now(), dogId, name: name||'Sin nombre', address, phone, status:'En revisión', created: new Date().toISOString(), reviewDue: new Date(Date.now()+21*24*60*60*1000).toISOString(), pickupWindow: '3-5 días'
  };
  solicitudes.push(solicitud);saveSolicitudes(solicitudes);renderSolicitudes();

  // Mostrar mensaje al usuario
  fichaEl.innerHTML = `
    <h2>Solicitud enviada ✔</h2>
    <p>Gracias, <strong>${escapeHtml(solicitud.name)}</strong>. Tu solicitud para adoptar a <strong>${DOGS.find(d=>d.id===dogId).name}</strong> ha sido enviada y está <strong>en revisión</strong>.</p>
    <div class="note">El estado del animal en adopción será revisado en un plazo de <strong>3 semanas</strong> (hasta el ${new Date(solicitud.reviewDue).toLocaleDateString()}). Si se aprueba, podrás recogerlo en un plazo de <strong>${solicitud.pickupWindow}</strong> como máximo.</div>
    <p class="muted" style="
